// Portfolio Database Schema
// Prisma ORM for PostgreSQL (Supabase)
// With i18n support via separate translation tables

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// ==================== LOCALIZATION ====================

model Locale {
  code       String  @id // "ru", "ro"
  name       String // "Russian", "Romanian"
  nativeName String // "Русский", "Română"
  isDefault  Boolean @default(false)
  isActive   Boolean @default(true)

  @@map("locales")
}

model UIString {
  id        String   @id @default(cuid())
  key       String // "hero.badge", "nav.home"
  locale    String // "ru", "ro"
  value     String   @db.Text
  namespace String? // "common", "hero", "projects"
  updatedAt DateTime @updatedAt

  @@unique([key, locale])
  @@index([namespace, locale])
  @@map("ui_strings")
}

// ==================== PROJECTS ====================

model Project {
  id       String   @id @default(cuid())
  slug     String   @unique
  category Category
  image    String
  video    Json? // { type: "file" | "vimeo", id?: string, src?: string }
  featured Boolean  @default(false)
  order    Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  translations ProjectTranslation[]
  technologies Technology[]
  features     Feature[]
  metrics      Metric[]
  links        ProjectLink?
  caseStudy    CaseStudy?

  @@index([category])
  @@index([featured])
}

model ProjectTranslation {
  id              String   @id @default(cuid())
  projectId       String
  locale          String
  title           String
  subtitle        String
  description     String
  fullDescription String   @db.Text
  categoryLabel   String
  // SEO fields
  metaTitle       String?
  metaDescription String?  @db.Text
  metaKeywords    String[]

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@unique([projectId, locale])
  @@index([locale])
}

enum Category {
  games
  fintech
  mobile
  enterprise
  automation
}

model Technology {
  id        String @id @default(cuid())
  projectId String
  name      String
  icon      String
  color     String
  order     Int    @default(0)

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
}

model Feature {
  id        String @id @default(cuid())
  projectId String
  icon      String
  order     Int    @default(0)

  project      Project              @relation(fields: [projectId], references: [id], onDelete: Cascade)
  translations FeatureTranslation[]

  @@index([projectId])
}

model FeatureTranslation {
  id          String @id @default(cuid())
  featureId   String
  locale      String
  title       String
  description String

  feature Feature @relation(fields: [featureId], references: [id], onDelete: Cascade)

  @@unique([featureId, locale])
  @@index([locale])
}

model Metric {
  id        String @id @default(cuid())
  projectId String
  value     String // "98/100", "0.8 sec" - locale-independent
  icon      String
  order     Int    @default(0)

  project      Project             @relation(fields: [projectId], references: [id], onDelete: Cascade)
  translations MetricTranslation[]

  @@index([projectId])
}

model MetricTranslation {
  id       String @id @default(cuid())
  metricId String
  locale   String
  label    String

  metric Metric @relation(fields: [metricId], references: [id], onDelete: Cascade)

  @@unique([metricId, locale])
  @@index([locale])
}

model ProjectLink {
  id        String  @id @default(cuid())
  projectId String  @unique
  demo      String?
  github    String?
  telegram  String?

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
}

// ==================== CASE STUDIES ====================

model CaseStudy {
  id        String @id @default(cuid())
  projectId String @unique

  project             Project                    @relation(fields: [projectId], references: [id], onDelete: Cascade)
  translations        CaseStudyTranslation[]
  performance         Performance?
  architecture        Architecture?
  userFlows           UserFlow[]
  technicalHighlights TechnicalHighlight[]
  integrations        Integration[]
  gallery             GalleryItem[]
  testimonial         CaseStudyTestimonial?
}

model CaseStudyTranslation {
  id          String   @id @default(cuid())
  caseStudyId String
  locale      String
  challenge   String   @db.Text
  solution    String   @db.Text
  results     String[]

  caseStudy CaseStudy @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)

  @@unique([caseStudyId, locale])
  @@index([locale])
}

model Performance {
  id            String @id @default(cuid())
  caseStudyId   String @unique
  score         Int
  accessibility Int
  bestPractices Int
  seo           Int
  fcp           String
  lcp           String
  tbt           String
  cls           String
  speedIndex    String

  caseStudy CaseStudy @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
}

model Architecture {
  id          String @id @default(cuid())
  caseStudyId String @unique

  caseStudy    CaseStudy                 @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
  translations ArchitectureTranslation[]
  layers       ArchitectureLayer[]
}

model ArchitectureTranslation {
  id             String @id @default(cuid())
  architectureId String
  locale         String
  description    String @db.Text

  architecture Architecture @relation(fields: [architectureId], references: [id], onDelete: Cascade)

  @@unique([architectureId, locale])
  @@index([locale])
}

model ArchitectureLayer {
  id             String   @id @default(cuid())
  architectureId String
  components     String[]
  color          String
  order          Int      @default(0)

  architecture Architecture                   @relation(fields: [architectureId], references: [id], onDelete: Cascade)
  translations  ArchitectureLayerTranslation[]

  @@index([architectureId])
}

model ArchitectureLayerTranslation {
  id      String @id @default(cuid())
  layerId String
  locale  String
  name    String

  layer ArchitectureLayer @relation(fields: [layerId], references: [id], onDelete: Cascade)

  @@unique([layerId, locale])
  @@index([locale])
}

model UserFlow {
  id          String @id @default(cuid())
  caseStudyId String
  icon        String
  order       Int    @default(0)

  caseStudy    CaseStudy             @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
  translations UserFlowTranslation[]
  steps        UserFlowStep[]

  @@index([caseStudyId])
}

model UserFlowTranslation {
  id          String @id @default(cuid())
  flowId      String
  locale      String
  title       String
  description String

  flow UserFlow @relation(fields: [flowId], references: [id], onDelete: Cascade)

  @@unique([flowId, locale])
  @@index([locale])
}

model UserFlowStep {
  id     String  @id @default(cuid())
  flowId String
  icon   String?
  order  Int     @default(0)

  flow         UserFlow                   @relation(fields: [flowId], references: [id], onDelete: Cascade)
  translations UserFlowStepTranslation[]

  @@index([flowId])
}

model UserFlowStepTranslation {
  id          String @id @default(cuid())
  stepId      String
  locale      String
  title       String
  description String

  step UserFlowStep @relation(fields: [stepId], references: [id], onDelete: Cascade)

  @@unique([stepId, locale])
  @@index([locale])
}

model TechnicalHighlight {
  id          String   @id @default(cuid())
  caseStudyId String
  icon        String
  codePreview String?  @db.Text
  order       Int      @default(0)

  caseStudy    CaseStudy                        @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
  translations TechnicalHighlightTranslation[]

  @@index([caseStudyId])
}

model TechnicalHighlightTranslation {
  id          String   @id @default(cuid())
  highlightId String
  locale      String
  title       String
  description String   @db.Text
  tags        String[]

  highlight TechnicalHighlight @relation(fields: [highlightId], references: [id], onDelete: Cascade)

  @@unique([highlightId, locale])
  @@index([locale])
}

model Integration {
  id          String @id @default(cuid())
  caseStudyId String
  name        String
  logo        String
  color       String
  order       Int    @default(0)

  caseStudy    CaseStudy                @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
  translations IntegrationTranslation[]

  @@index([caseStudyId])
}

model IntegrationTranslation {
  id            String @id @default(cuid())
  integrationId String
  locale        String
  description   String

  integration Integration @relation(fields: [integrationId], references: [id], onDelete: Cascade)

  @@unique([integrationId, locale])
  @@index([locale])
}

model GalleryItem {
  id            String          @id @default(cuid())
  caseStudyId   String
  type          GalleryItemType @default(IMAGE)
  src           String          // For images and local videos
  videoUrl      String?         // For external videos (Vimeo embed URL)
  videoProvider String?         // vimeo, youtube, local
  order         Int             @default(0)

  caseStudy    CaseStudy                @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
  translations GalleryItemTranslation[]

  @@index([caseStudyId])
}

enum GalleryItemType {
  IMAGE
  VIDEO
}

model GalleryItemTranslation {
  id        String  @id @default(cuid())
  galleryId String
  locale    String
  alt       String
  caption   String?

  gallery GalleryItem @relation(fields: [galleryId], references: [id], onDelete: Cascade)

  @@unique([galleryId, locale])
  @@index([locale])
}

model CaseStudyTestimonial {
  id          String  @id @default(cuid())
  caseStudyId String  @unique
  avatar      String?

  caseStudy    CaseStudy                         @relation(fields: [caseStudyId], references: [id], onDelete: Cascade)
  translations CaseStudyTestimonialTranslation[]
}

model CaseStudyTestimonialTranslation {
  id            String @id @default(cuid())
  testimonialId String
  locale        String
  quote         String @db.Text
  author        String
  role          String

  testimonial CaseStudyTestimonial @relation(fields: [testimonialId], references: [id], onDelete: Cascade)

  @@unique([testimonialId, locale])
  @@index([locale])
}

// ==================== TESTIMONIALS ====================

model Testimonial {
  id        String   @id @default(cuid())
  rating    Int      @default(5)
  source    String?  @default("YouDo")
  createdAt DateTime @default(now())
  order     Int      @default(0)

  translations TestimonialTranslation[]

  @@index([rating])
}

model TestimonialTranslation {
  id            String @id @default(cuid())
  testimonialId String
  locale        String
  author        String
  task          String
  text          String @db.Text

  testimonial Testimonial @relation(fields: [testimonialId], references: [id], onDelete: Cascade)

  @@unique([testimonialId, locale])
  @@index([locale])
}

model TestimonialStats {
  id            String   @id @default("default")
  avgRating     Float    @default(4.9)
  totalPositive Int      @default(0)
  totalNegative Int      @default(0)
  platform      String   @default("YouDo")
  platformUrl   String?
  updatedAt     DateTime @updatedAt
}

// ==================== TEAM ====================

model TeamMember {
  id        String   @id @default(cuid())
  photo     String
  skills    String[]
  isFounder Boolean  @default(false)
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  translations TeamMemberTranslation[]
  socialLinks  TeamMemberSocial?
}

model TeamMemberTranslation {
  id          String  @id @default(cuid())
  memberId    String
  locale      String
  name        String
  role        String
  description String  @db.Text
  bio         String? @db.Text

  member TeamMember @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@unique([memberId, locale])
  @@index([locale])
}

model TeamMemberSocial {
  id       String  @id @default(cuid())
  memberId String  @unique
  github   String?
  telegram String?
  linkedin String?

  member TeamMember @relation(fields: [memberId], references: [id], onDelete: Cascade)
}

// ==================== SKILLS & TECH STACK ====================

model SkillCategory {
  id    String   @id @default(cuid())
  icon  String
  color String
  items String[]
  order Int      @default(0)

  translations SkillCategoryTranslation[]
}

model SkillCategoryTranslation {
  id         String @id @default(cuid())
  categoryId String
  locale     String
  name       String

  category SkillCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([categoryId, locale])
  @@index([locale])
}

model TechStackItem {
  id       String  @id @default(cuid())
  name     String
  icon     String
  color    String
  category String
  featured Boolean @default(false)
  order    Int     @default(0)
}

// ==================== WORK PROCESS ====================

model WorkProcessStep {
  id     String @id @default(cuid())
  number String // "01", "02", etc.
  icon   String
  color  String
  order  Int    @default(0)

  translations WorkProcessStepTranslation[]
}

model WorkProcessStepTranslation {
  id          String @id @default(cuid())
  stepId      String
  locale      String
  title       String
  description String @db.Text

  step WorkProcessStep @relation(fields: [stepId], references: [id], onDelete: Cascade)

  @@unique([stepId, locale])
  @@index([locale])
}

// ==================== PRICING ====================

model PricingPackage {
  id      String  @id @default(cuid())
  price   String
  icon    String
  color   String
  popular Boolean @default(false)
  order   Int     @default(0)

  translations PricingPackageTranslation[]
}

model PricingPackageTranslation {
  id          String   @id @default(cuid())
  packageId   String
  locale      String
  name        String
  description String
  features    String[]
  notIncluded String[]

  package PricingPackage @relation(fields: [packageId], references: [id], onDelete: Cascade)

  @@unique([packageId, locale])
  @@index([locale])
}

model AdditionalService {
  id    String @id @default(cuid())
  price String
  order Int    @default(0)

  translations AdditionalServiceTranslation[]
}

model AdditionalServiceTranslation {
  id          String @id @default(cuid())
  serviceId   String
  locale      String
  name        String
  description String

  service AdditionalService @relation(fields: [serviceId], references: [id], onDelete: Cascade)

  @@unique([serviceId, locale])
  @@index([locale])
}

// ==================== FAQ ====================

model FaqItem {
  id           String   @id @default(cuid())
  category     String?
  helpfulCount Int      @default(0)
  order        Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  translations FaqItemTranslation[]
}

model FaqItemTranslation {
  id        String @id @default(cuid())
  faqItemId String
  locale    String
  question  String
  answer    String @db.Text

  faqItem FaqItem @relation(fields: [faqItemId], references: [id], onDelete: Cascade)

  @@unique([faqItemId, locale])
  @@index([locale])
}

// ==================== CONTACT ====================

model ContactInfo {
  id        String   @id @default("default")
  email     String
  telegram  String
  github    String
  youdoUrl  String?
  updatedAt DateTime @updatedAt

  translations ContactInfoTranslation[]
}

model ContactInfoTranslation {
  id           String @id @default(cuid())
  contactId    String
  locale       String
  responseTime String @default("24 часа")

  contact ContactInfo @relation(fields: [contactId], references: [id], onDelete: Cascade)

  @@unique([contactId, locale])
  @@index([locale])
}

model ContactSubmission {
  id        String           @id @default(cuid())
  name      String
  email     String
  subject   String?
  message   String           @db.Text
  status    SubmissionStatus @default(NEW)
  response  String?          @db.Text
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  @@index([status])
  @@index([createdAt])
}

enum SubmissionStatus {
  NEW
  READ
  RESPONDED
}

// ==================== SITE SETTINGS ====================

model SiteSettings {
  id            String   @id @default("default")
  heroTechStack String[]
  projectsCount Int      @default(17)
  rating        Float    @default(4.9)
  countriesCount Int     @default(5)
  founderPhoto  String
  updatedAt     DateTime @updatedAt

  translations SiteSettingsTranslation[]
}

model SiteSettingsTranslation {
  id              String   @id @default(cuid())
  settingsId      String
  locale          String
  companyName     String   @default("METABYTE")
  subtitle        String   @default("Full-Stack Development Studio")
  badgeText       String
  heroServices    String[]
  founderName     String
  founderTitle    String
  founderBioShort String   @db.Text
  founderBioLong  String?  @db.Text

  settings SiteSettings @relation(fields: [settingsId], references: [id], onDelete: Cascade)

  @@unique([settingsId, locale])
  @@index([locale])
}

// ==================== PROJECT CATEGORIES (Lookup) ====================

model ProjectCategory {
  id    String @id @default(cuid())
  value String @unique
  order Int    @default(0)

  translations ProjectCategoryTranslation[]
}

model ProjectCategoryTranslation {
  id         String @id @default(cuid())
  categoryId String
  locale     String
  label      String

  category ProjectCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([categoryId, locale])
  @@index([locale])
}

// ==================== ADMIN PANEL ====================

model AdminUser {
  id           String    @id @default(cuid())
  email        String    @unique
  passwordHash String
  name         String
  role         AdminRole @default(ADMIN)
  isActive     Boolean   @default(true)
  lastLoginAt  DateTime?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  auditLogs AdminAuditLog[]

  @@map("admin_users")
}

enum AdminRole {
  SUPER_ADMIN
  ADMIN
}

model AdminAuditLog {
  id         String   @id @default(cuid())
  adminId    String
  action     String
  targetType String?
  targetId   String?
  details    Json?
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime @default(now())

  admin AdminUser @relation(fields: [adminId], references: [id], onDelete: Cascade)

  @@index([action])
  @@index([targetType, targetId])
  @@index([createdAt])
  @@map("admin_audit_logs")
}

// ==================== VISITOR TRACKING ====================

model Visitor {
  id           String   @id @default(cuid())
  visitorId    String   @unique // UUID from localStorage
  ipAddress    String?
  userAgent    String?
  city         String?
  country      String?
  firstVisitAt DateTime @default(now())
  lastVisitAt  DateTime @updatedAt
  totalVisits  Int      @default(1)

  chatSessions ChatSession[]
  pageViews    PageView[]
  contact      VisitorContact?

  @@index([city])
  @@index([country])
  @@index([lastVisitAt])
  @@map("visitors")
}

model VisitorContact {
  id          String   @id @default(cuid())
  visitorId   String   @unique
  name        String
  contact     String // Telegram or phone
  message     String?  @db.Text
  source      String   @default("ai_assistant") // ai_assistant, contact_form
  collectedAt DateTime @default(now())

  visitor Visitor @relation(fields: [visitorId], references: [id], onDelete: Cascade)

  @@map("visitor_contacts")
}

// ==================== CHAT SESSIONS ====================

model ChatSession {
  id              String     @id @default(cuid())
  visitorId       String
  sessionToken    String     @unique @default(cuid())
  status          ChatStatus @default(ACTIVE)
  startedAt       DateTime   @default(now())
  endedAt         DateTime?
  lastActivityAt  DateTime   @updatedAt
  currentPage     String?
  locale          String     @default("ru")
  isAdminTakeover Boolean    @default(false)
  adminTakeoverBy String?

  visitor  Visitor       @relation(fields: [visitorId], references: [id], onDelete: Cascade)
  messages ChatMessage[]

  @@index([status])
  @@index([lastActivityAt])
  @@index([isAdminTakeover])
  @@map("chat_sessions")
}

enum ChatStatus {
  ACTIVE
  ADMIN_ACTIVE
  ENDED
  ABANDONED
}

model ChatMessage {
  id        String      @id @default(cuid())
  sessionId String
  role      MessageRole
  content   String      @db.Text
  metadata  Json? // Function calls, effects shown, etc.
  createdAt DateTime    @default(now())

  session ChatSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([sessionId, createdAt])
  @@map("chat_messages")
}

enum MessageRole {
  USER
  ASSISTANT
  ADMIN
  SYSTEM
}

// ==================== PAGE ANALYTICS ====================

model PageView {
  id          String   @id @default(cuid())
  visitorId   String
  path        String
  title       String?
  referrer    String?
  duration    Int? // Seconds on page
  scrollDepth Int? // Max scroll percentage
  createdAt   DateTime @default(now())

  visitor Visitor @relation(fields: [visitorId], references: [id], onDelete: Cascade)

  @@index([path])
  @@index([createdAt])
  @@index([visitorId])
  @@map("page_views")
}

model AnalyticsEvent {
  id        String   @id @default(cuid())
  visitorId String?
  eventType String // click, scroll, form_submit, project_view, etc.
  eventData Json?
  page      String
  createdAt DateTime @default(now())

  @@index([eventType])
  @@index([createdAt])
  @@map("analytics_events")
}

// ==================== MEDIA UPLOADS ====================

model MediaUpload {
  id           String   @id @default(cuid())
  filename     String
  originalName String
  mimeType     String
  size         Int // bytes
  url          String
  bucket       String   @default("portfolio-media")
  path         String
  uploadedBy   String // AdminUser id
  linkedTo     String? // project:slug, testimonial:id, etc.
  createdAt    DateTime @default(now())

  translations MediaUploadTranslation[]

  @@index([linkedTo])
  @@index([createdAt])
  @@map("media_uploads")
}

model MediaUploadTranslation {
  id          String  @id @default(cuid())
  mediaId     String
  locale      String
  altText     String
  title       String?
  description String? @db.Text

  media MediaUpload @relation(fields: [mediaId], references: [id], onDelete: Cascade)

  @@unique([mediaId, locale])
  @@index([locale])
  @@map("media_upload_translations")
}

// ==================== PAGE SEO ====================

model PageSEO {
  id        String   @id @default(cuid())
  pageKey   String   @unique // "home", "about", "contact", "pricing", "projects"
  ogImage   String?
  updatedAt DateTime @updatedAt

  translations PageSEOTranslation[]

  @@map("page_seo")
}

model PageSEOTranslation {
  id              String   @id @default(cuid())
  pageSeoId       String
  locale          String
  metaTitle       String
  metaDescription String   @db.Text
  metaKeywords    String[]

  pageSeo PageSEO @relation(fields: [pageSeoId], references: [id], onDelete: Cascade)

  @@unique([pageSeoId, locale])
  @@index([locale])
  @@map("page_seo_translations")
}

// ==================== BLOG ====================

model Post {
  id          String    @id @default(cuid())
  slug        String    @unique
  coverImage  String?
  published   Boolean   @default(false)
  publishedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  order       Int       @default(0)

  translations PostTranslation[]
  categories   PostCategory[]
  tags         PostTag[]

  @@index([published])
  @@index([publishedAt])
  @@map("posts")
}

model PostTranslation {
  id          String  @id @default(cuid())
  postId      String
  locale      String
  title       String
  excerpt     String? @db.Text
  content     String  @db.Text

  post Post @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@unique([postId, locale])
  @@index([locale])
  @@map("post_translations")
}

model PostCategory {
  id    String @id @default(cuid())
  slug  String @unique
  order Int    @default(0)

  posts Post[]

  translations PostCategoryTranslation[]

  @@map("post_categories")
}

model PostCategoryTranslation {
  id         String @id @default(cuid())
  categoryId String
  locale     String
  name       String

  category PostCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([categoryId, locale])
  @@index([locale])
  @@map("post_category_translations")
}

model PostTag {
  id    String @id @default(cuid())
  slug  String @unique
  color String @default("#6366f1")
  order Int    @default(0)

  posts Post[]

  translations PostTagTranslation[]

  @@map("post_tags")
}

model PostTagTranslation {
  id     String @id @default(cuid())
  tagId  String
  locale String
  name   String

  tag PostTag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@unique([tagId, locale])
  @@index([locale])
  @@map("post_tag_translations")
}

// ==================== LEADS CRM ====================

model Lead {
  id          String     @id @default(cuid())
  name        String?
  email       String?
  telegram    String?
  phone       String?
  budget      String?
  source      String     @default("website") // website, referral, ai_assistant
  projectType String?
  message     String     @db.Text
  status      LeadStatus @default(NEW)
  priority    Int        @default(0) // 0=normal, 1=high, 2=urgent
  assignedTo  String?    // AdminUser id
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  notes   LeadNote[]
  history LeadStatusHistory[]

  @@index([status])
  @@index([createdAt])
  @@index([priority])
  @@map("leads")
}

enum LeadStatus {
  NEW
  CONTACTED
  QUALIFIED
  PROPOSAL
  NEGOTIATION
  WON
  LOST
}

model LeadNote {
  id        String   @id @default(cuid())
  leadId    String
  authorId  String   // AdminUser id
  content   String   @db.Text
  isInternal Boolean @default(true) // True = only visible to admins
  createdAt DateTime @default(now())

  lead Lead @relation(fields: [leadId], references: [id], onDelete: Cascade)

  @@index([leadId])
  @@map("lead_notes")
}

model LeadStatusHistory {
  id        String     @id @default(cuid())
  leadId    String
  fromStatus LeadStatus?
  toStatus   LeadStatus
  changedBy  String     // AdminUser id
  createdAt  DateTime   @default(now())

  lead Lead @relation(fields: [leadId], references: [id], onDelete: Cascade)

  @@index([leadId])
  @@map("lead_status_history")
}
